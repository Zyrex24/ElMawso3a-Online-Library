{% load static %}

<header class="bg-white shadow-lg border-b border-gray-200 sticky top-0 z-40" role="banner">
    <nav class="container mx-auto px-4 sm:px-6 lg:px-8" role="navigation" aria-label="Main navigation">
        <div class="flex justify-between items-center h-16">
            <!-- Logo -->
            <div class="flex-shrink-0">
                <a href="{% url 'index' %}" class="navbar-brand" aria-label="ElMawso3a Home">
                    <img src="{% static 'images/logo.svg' %}" alt="ElMawso3a Logo" class="h-10 w-auto">
                    <span class="ml-2 text-xl font-bold text-primary-700 hidden sm:block">ElMawso3a</span>
                </a>
            </div>
            
            <!-- Desktop Navigation -->
            <div class="hidden md:flex md:items-center md:space-x-8">
                <a href="{% url 'books' %}" class="text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors" aria-label="Browse Books">
                    <i class="fas fa-book mr-1" aria-hidden="true"></i>
                    <span data-en="Books" data-ar="الكتب">Books</span>
                </a>
                
                {% if user.is_authenticated %}
                    <a href="{% url 'profile' %}" class="text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors" aria-label="My Profile">
                        <i class="fas fa-user mr-1" aria-hidden="true"></i>
                        <span data-en="Profile" data-ar="الملف الشخصي">Profile</span>
                    </a>
                    
                    <a href="{% url 'cart' %}" class="text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors relative" aria-label="My Cart">
                        <i class="fas fa-shopping-cart mr-1" aria-hidden="true"></i>
                        <span data-en="Cart" data-ar="السلة">Cart</span>
                        <!-- Cart count badge could go here -->
                    </a>
                    
                    <a href="{% url 'borrowedbooks' %}" class="text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors" aria-label="Borrowed Books">
                        <i class="fas fa-bookmark mr-1" aria-hidden="true"></i>
                        <span data-en="Borrowed" data-ar="المستعارة">Borrowed</span>
                    </a>
                {% endif %}
                
                <a href="{% url 'feedback' %}" class="text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors" aria-label="Feedback">
                    <i class="fas fa-comment mr-1" aria-hidden="true"></i>
                    <span data-en="Feedback" data-ar="التعليقات">Feedback</span>
                </a>
            </div>
            
            <!-- Right side: Language toggle, Auth, Admin -->
            <div class="flex items-center space-x-4">
                <!-- Language Toggle -->
                <button ng-click="toggleLanguage()" class="language-toggle" aria-label="Toggle Language" title="Switch Language">
                    <i class="fas fa-globe mr-1" aria-hidden="true"></i>
                    <span ng-if="currentLang === 'en'">عربي</span>
                    <span ng-if="currentLang === 'ar'">English</span>
                </button>
                
                {% if user.is_authenticated %}
                    <!-- Admin Dashboard (if staff) -->
                    {% if request.user.is_staff %}
                        <a href="{% url 'admin' %}" class="hidden md:inline-flex items-center px-3 py-2 border border-primary-600 text-sm font-medium rounded-md text-primary-600 bg-white hover:bg-primary-50 transition-colors" aria-label="Admin Dashboard">
                            <i class="fas fa-cog mr-1" aria-hidden="true"></i>
                            <span data-en="Admin" data-ar="الإدارة">Admin</span>
                        </a>
                    {% endif %}
                    
                    <!-- User Menu -->
                    <div class="relative" x-data="{ open: false }">
                        <button @click="open = !open" class="flex items-center text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500" aria-label="User menu" aria-expanded="false">
                            <span class="sr-only">Open user menu</span>
                            <div class="h-8 w-8 rounded-full bg-primary-600 flex items-center justify-center text-white font-medium">
                                {{ request.user.username|first|upper }}
                            </div>
                            <span class="ml-2 text-gray-700 font-medium hidden sm:block">{{ request.user.username }}</span>
                            <i class="fas fa-chevron-down ml-1 text-gray-400" aria-hidden="true"></i>
                        </button>
                        
                        <!-- Dropdown menu -->
                        <div x-show="open" @click.away="open = false" x-transition class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none" role="menu">
                            <div class="py-1">
                                <a href="{% url 'profile' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">
                                    <i class="fas fa-user mr-2" aria-hidden="true"></i>
                                    <span data-en="Profile" data-ar="الملف الشخصي">Profile</span>
                                </a>
                                <a href="{% url 'logout' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">
                                    <i class="fas fa-sign-out-alt mr-2" aria-hidden="true"></i>
                                    <span data-en="Logout" data-ar="تسجيل الخروج">Logout</span>
                                </a>
                            </div>
                        </div>
                    </div>
                {% else %}
                    <!-- Login/Register for non-authenticated users -->
                    <a href="{% url 'login' %}" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 transition-colors" aria-label="Login or Register">
                        <i class="fas fa-sign-in-alt mr-1" aria-hidden="true"></i>
                        <span data-en="Login" data-ar="تسجيل الدخول">Login</span>
                    </a>
                {% endif %}
                
                <!-- Mobile menu button -->
                <button id="mobile-menu-btn" class="md:hidden inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500" aria-expanded="false" aria-label="Toggle mobile menu">
                    <span class="sr-only">Open main menu</span>
                    <i class="fas fa-bars" aria-hidden="true"></i>
                </button>
            </div>
        </div>
        
        <!-- Mobile Navigation Menu -->
        <div id="mobile-menu" class="md:hidden hidden">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3 border-t border-gray-200">
                <a href="{% url 'books' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-gray-50">
                    <i class="fas fa-book mr-2" aria-hidden="true"></i>
                    <span data-en="Books" data-ar="الكتب">Books</span>
                </a>
                
                {% if user.is_authenticated %}
                    <a href="{% url 'profile' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-gray-50">
                        <i class="fas fa-user mr-2" aria-hidden="true"></i>
                        <span data-en="Profile" data-ar="الملف الشخصي">Profile</span>
                    </a>
                    
                    <a href="{% url 'cart' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-gray-50">
                        <i class="fas fa-shopping-cart mr-2" aria-hidden="true"></i>
                        <span data-en="Cart" data-ar="السلة">Cart</span>
                    </a>
                    
                    <a href="{% url 'borrowedbooks' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-gray-50">
                        <i class="fas fa-bookmark mr-2" aria-hidden="true"></i>
                        <span data-en="Borrowed" data-ar="المستعارة">Borrowed</span>
                    </a>
                    
                    {% if request.user.is_staff %}
                        <a href="{% url 'admin' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-gray-50">
                            <i class="fas fa-cog mr-2" aria-hidden="true"></i>
                            <span data-en="Admin" data-ar="الإدارة">Admin</span>
                        </a>
                    {% endif %}
                {% endif %}
                
                <a href="{% url 'feedback' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-gray-50">
                    <i class="fas fa-comment mr-2" aria-hidden="true"></i>
                    <span data-en="Feedback" data-ar="التعليقات">Feedback</span>
                </a>
                
                {% if not user.is_authenticated %}
                    <a href="{% url 'login' %}" class="block px-3 py-2 rounded-md text-base font-medium text-white bg-primary-600 hover:bg-primary-700">
                        <i class="fas fa-sign-in-alt mr-2" aria-hidden="true"></i>
                        <span data-en="Login" data-ar="تسجيل الدخول">Login</span>
                    </a>
                {% else %}
                    <a href="{% url 'logout' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-gray-50">
                        <i class="fas fa-sign-out-alt mr-2" aria-hidden="true"></i>
                        <span data-en="Logout" data-ar="تسجيل الخروج">Logout</span>
                    </a>
                {% endif %}
            </div>
        </div>
    </nav>
</header>